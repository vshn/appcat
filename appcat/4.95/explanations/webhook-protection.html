<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns/website#">
  <head itemscope itemtype="http://schema.org/WebSite">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Webhook based deletion protection :: Application Catalog</title>
    <meta property="og:title" itemprop="name" content="Webhook based deletion protection">
    <meta name="twitter:title" content="Webhook based deletion protection">
    <link rel="canonical" href="https://vshn.github.io/appcat/appcat/explanations/webhook-protection.html">
    <meta property="og:url" content="https://vshn.github.io/appcat/appcat/explanations/webhook-protection.html">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Application Catalog" />
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="vshn_ch">
    <meta property="og:locale" content="en_US" />
    <script>var uiRootPath = '../../../_'</script>
    <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/7105834.js"></script>
<meta name="apple-mobile-web-app-capable" content="yes" />
<link rel="apple-touch-icon" sizes="152x152" href="/_/img/favicon-152x152.png">
<link rel="apple-touch-icon" sizes="167x167" href="/_/img/favicon-167x167.png">
<link rel="apple-touch-icon" sizes="180x180" href="/_/img/favicon-180x180.png">

<link rel="icon" type="image/png" href="/_/img/favicon-196x196.png" sizes="196x196">
<link rel="icon" type="image/png" href="/_/img/favicon-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/_/img/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/_/img/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/_/img/favicon-32x32.png" sizes="32x32">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <div class="vshn_logo"></div>
        <a href="https://vshn.github.io/appcat">Application Catalog
           â€“
          v4.95</a>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">VSHN</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" target="_blank" href="https://www.vshn.ch/">Main website</a>
            <a class="navbar-item" target="_blank" href="https://handbook.vshn.ch/">Handbook</a>
            <a class="navbar-item" target="_blank" href="https://kb.vshn.ch/">Knowledge Base</a>
            <a class="navbar-item" target="_blank" href="https://products.docs.vshn.ch/">Products</a>
            <a class="navbar-item" target="_blank" href="https://legal.docs.vshn.ch/">Legal</a>
            <a class="navbar-item" target="_blank" href="https://control.docs.vshn.ch/">Portal Help</a>
            <a class="navbar-item" target="_blank" href="https://docs.appuio.cloud/">APPUiO Cloud Docs</a>
            <a class="navbar-item" target="_blank" href="https://syn.tools/">Project Syn</a>
            <a class="navbar-item" target="_blank" href="https://k8up.io/">K8up</a>
          </div>
        </div>
        <div class="navbar-item">
          <div class="search-field">
            <input id="search-input" class="search-input" type="search" placeholder="Search">
            <button type="submit" class="search-button">
              <i class="fa fa-search"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="appcat" data-version="4.95">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Application Catalog</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="https://github.com/vshn/appcat/releases" target="_blank" rel="noopener">Changelog</a> ðŸ”—</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">How To</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../examples/vscode.html">VSCode Launch Configs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../how-tos/bootstrap_api.html">Boostrap API</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Technical reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../references/apiserver/env-variables.html">Env variables</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Explanation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="comp-functions/runtime.html">Runtime Library</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="comp-functions/vshn-postgres.html">VSHN Postgres Functions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#explanations/boostrap_api.adoc">Bootstrap AppCat service API definition</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="slareports.html">SLA Reports</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dev-notes.html">Dev Notes for Composition Functions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="comp-functions/debug.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="comp-functions/redis-pvc-resize.html">Redis PVC resize</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="webhooks.html">Webhooks</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="connectiondetails.html">Connection Details</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="helm-maintenance.html">Helm Maintenance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="disable-billing.html">How Disabling Billing Works</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="webhook-protection.html">Webhook based deletion protection</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ordered-deletion.html">Ordered Deletion</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Application Catalog</span>
    <span class="version">4.95</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Application Catalog</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../index.html">master</a>
        </li>
        <li class="version">
          <a href="../../4.98/index.html">4.98</a>
        </li>
        <li class="version">
          <a href="../../4.97/index.html">4.97</a>
        </li>
        <li class="version">
          <a href="../../4.96/index.html">4.96</a>
        </li>
        <li class="version is-current">
          <a href="../index.html">4.95</a>
        </li>
        <li class="version">
          <a href="../../4.94/index.html">4.94</a>
        </li>
        <li class="version">
          <a href="../../4.93/index.html">4.93</a>
        </li>
        <li class="version">
          <a href="../../4.92/index.html">4.92</a>
        </li>
        <li class="version">
          <a href="../../4.91/index.html">4.91</a>
        </li>
        <li class="version">
          <a href="../../4.90/index.html">4.90</a>
        </li>
        <li class="version">
          <a href="../../4.89/index.html">4.89</a>
        </li>
        <li class="version">
          <a href="../../4.88/index.html">4.88</a>
        </li>
        <li class="version">
          <a href="../../4.87/index.html">4.87</a>
        </li>
        <li class="version">
          <a href="../../4.86/index.html">4.86</a>
        </li>
        <li class="version">
          <a href="../../4.85/index.html">4.85</a>
        </li>
        <li class="version">
          <a href="../../4.84/index.html">4.84</a>
        </li>
        <li class="version">
          <a href="../../4.83/index.html">4.83</a>
        </li>
        <li class="version">
          <a href="../../4.82/index.html">4.82</a>
        </li>
        <li class="version">
          <a href="../../4.81/index.html">4.81</a>
        </li>
        <li class="version">
          <a href="../../4.80/index.html">4.80</a>
        </li>
        <li class="version">
          <a href="../../4.79/index.html">4.79</a>
        </li>
        <li class="version">
          <a href="../../4.78/index.html">4.78</a>
        </li>
        <li class="version">
          <a href="../../4.77/index.html">4.77</a>
        </li>
        <li class="version">
          <a href="../../4.76/index.html">4.76</a>
        </li>
        <li class="version">
          <a href="../../4.75/index.html">4.75</a>
        </li>
        <li class="version">
          <a href="../../4.74/index.html">4.74</a>
        </li>
        <li class="version">
          <a href="../../4.73/index.html">4.73</a>
        </li>
        <li class="version">
          <a href="../../4.72/index.html">4.72</a>
        </li>
        <li class="version">
          <a href="../../4.71/index.html">4.71</a>
        </li>
        <li class="version">
          <a href="../../4.70/index.html">4.70</a>
        </li>
        <li class="version">
          <a href="../../4.69/index.html">4.69</a>
        </li>
        <li class="version">
          <a href="../../4.68/index.html">4.68</a>
        </li>
        <li class="version">
          <a href="../../4.67/index.html">4.67</a>
        </li>
        <li class="version">
          <a href="../../4.66/index.html">4.66</a>
        </li>
        <li class="version">
          <a href="../../4.65/index.html">4.65</a>
        </li>
        <li class="version">
          <a href="../../4.64/index.html">4.64</a>
        </li>
        <li class="version">
          <a href="../../4.63/index.html">4.63</a>
        </li>
        <li class="version">
          <a href="../../4.62/index.html">4.62</a>
        </li>
        <li class="version">
          <a href="../../4.61/index.html">4.61</a>
        </li>
        <li class="version">
          <a href="../../4.60/index.html">4.60</a>
        </li>
        <li class="version">
          <a href="../../4.59/index.html">4.59</a>
        </li>
        <li class="version">
          <a href="../../4.58/index.html">4.58</a>
        </li>
        <li class="version">
          <a href="../../4.57/index.html">4.57</a>
        </li>
        <li class="version">
          <a href="../../4.56/index.html">4.56</a>
        </li>
        <li class="version">
          <a href="../../4.55/index.html">4.55</a>
        </li>
        <li class="version">
          <a href="../../4.54/index.html">4.54</a>
        </li>
        <li class="version">
          <a href="../../4.53/index.html">4.53</a>
        </li>
        <li class="version">
          <a href="../../4.52/index.html">4.52</a>
        </li>
        <li class="version">
          <a href="../../4.51/index.html">4.51</a>
        </li>
        <li class="version">
          <a href="../../4.50/index.html">4.50</a>
        </li>
        <li class="version">
          <a href="../../4.49/index.html">4.49</a>
        </li>
        <li class="version">
          <a href="../../4.48/index.html">4.48</a>
        </li>
        <li class="version">
          <a href="../../4.47/index.html">4.47</a>
        </li>
        <li class="version">
          <a href="../../4.46/index.html">4.46</a>
        </li>
        <li class="version">
          <a href="../../4.45/index.html">4.45</a>
        </li>
        <li class="version">
          <a href="../../4.44/index.html">4.44</a>
        </li>
        <li class="version">
          <a href="../../4.43/index.html">4.43</a>
        </li>
        <li class="version">
          <a href="../../4.42/index.html">4.42</a>
        </li>
        <li class="version">
          <a href="../../4.41/index.html">4.41</a>
        </li>
        <li class="version">
          <a href="../../4.40/index.html">4.40</a>
        </li>
        <li class="version">
          <a href="../../4.39/index.html">4.39</a>
        </li>
        <li class="version">
          <a href="../../4.38/index.html">4.38</a>
        </li>
        <li class="version">
          <a href="../../4.37/index.html">4.37</a>
        </li>
        <li class="version">
          <a href="../../4.36/index.html">4.36</a>
        </li>
        <li class="version">
          <a href="../../4.35/index.html">4.35</a>
        </li>
        <li class="version">
          <a href="../../4.34/index.html">4.34</a>
        </li>
        <li class="version">
          <a href="../../4.33/index.html">4.33</a>
        </li>
        <li class="version">
          <a href="../../4.32/index.html">4.32</a>
        </li>
        <li class="version">
          <a href="../../4.31/index.html">4.31</a>
        </li>
        <li class="version">
          <a href="../../4.30/index.html">4.30</a>
        </li>
        <li class="version">
          <a href="../../4.29/index.html">4.29</a>
        </li>
        <li class="version">
          <a href="../../4.28/index.html">4.28</a>
        </li>
        <li class="version">
          <a href="../../4.27/index.html">4.27</a>
        </li>
        <li class="version">
          <a href="../../4.26/index.html">4.26</a>
        </li>
        <li class="version">
          <a href="../../4.25/index.html">4.25</a>
        </li>
        <li class="version">
          <a href="../../4.24/index.html">4.24</a>
        </li>
        <li class="version">
          <a href="../../4.23/index.html">4.23</a>
        </li>
        <li class="version">
          <a href="../../4.22/index.html">4.22</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../go-bootstrap/index.html">Go Bootstrap</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../go-bootstrap/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.21/index.html">4.21</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.20/index.html">4.20</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.19/index.html">4.19</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.18/index.html">4.18</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.17/index.html">4.17</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.16/index.html">4.16</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.15/index.html">4.15</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.14/index.html">4.14</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.13/index.html">4.13</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.12/index.html">4.12</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.11/index.html">4.11</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.10/index.html">4.10</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.9/index.html">4.9</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.8/index.html">4.8</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.7/index.html">4.7</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.6/index.html">4.6</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.5/index.html">4.5</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.4/index.html">4.4</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.3/index.html">4.3</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.2/index.html">4.2</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.1/index.html">4.1</a>
        </li>
        <li class="version">
          <a href="../../../go-bootstrap/4.0/index.html">4.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Application Catalog</a></li>
    <li>Explanation</li>
    <li><a href="webhook-protection.html">Webhook based deletion protection</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">4.95</button>
  <div class="version-menu">
    <a class="version" href="../../explanations/webhook-protection.html">master</a>
    <a class="version" href="../../4.98/explanations/webhook-protection.html">4.98</a>
    <a class="version" href="../../4.97/explanations/webhook-protection.html">4.97</a>
    <a class="version" href="../../4.96/explanations/webhook-protection.html">4.96</a>
    <a class="version is-current" href="webhook-protection.html">4.95</a>
    <a class="version" href="../../4.94/explanations/webhook-protection.html">4.94</a>
    <a class="version" href="../../4.93/explanations/webhook-protection.html">4.93</a>
    <a class="version" href="../../4.92/explanations/webhook-protection.html">4.92</a>
    <a class="version" href="../../4.91/explanations/webhook-protection.html">4.91</a>
    <a class="version" href="../../4.90/explanations/webhook-protection.html">4.90</a>
    <a class="version" href="../../4.89/explanations/webhook-protection.html">4.89</a>
    <a class="version" href="../../4.88/explanations/webhook-protection.html">4.88</a>
    <a class="version" href="../../4.87/explanations/webhook-protection.html">4.87</a>
    <a class="version" href="../../4.86/explanations/webhook-protection.html">4.86</a>
    <a class="version" href="../../4.85/explanations/webhook-protection.html">4.85</a>
    <a class="version" href="../../4.84/explanations/webhook-protection.html">4.84</a>
    <a class="version" href="../../4.83/explanations/webhook-protection.html">4.83</a>
    <a class="version" href="../../4.82/explanations/webhook-protection.html">4.82</a>
    <a class="version" href="../../4.81/explanations/webhook-protection.html">4.81</a>
    <a class="version" href="../../4.80/explanations/webhook-protection.html">4.80</a>
    <a class="version" href="../../4.79/explanations/webhook-protection.html">4.79</a>
    <a class="version" href="../../4.78/explanations/webhook-protection.html">4.78</a>
    <a class="version" href="../../4.77/explanations/webhook-protection.html">4.77</a>
    <a class="version" href="../../4.76/explanations/webhook-protection.html">4.76</a>
    <a class="version" href="../../4.75/explanations/webhook-protection.html">4.75</a>
    <a class="version" href="../../4.74/explanations/webhook-protection.html">4.74</a>
    <a class="version" href="../../4.73/explanations/webhook-protection.html">4.73</a>
    <a class="version" href="../../4.72/explanations/webhook-protection.html">4.72</a>
    <a class="version" href="../../4.71/explanations/webhook-protection.html">4.71</a>
    <a class="version" href="../../4.70/explanations/webhook-protection.html">4.70</a>
    <a class="version" href="../../4.69/explanations/webhook-protection.html">4.69</a>
    <a class="version" href="../../4.68/explanations/webhook-protection.html">4.68</a>
    <a class="version" href="../../4.67/explanations/webhook-protection.html">4.67</a>
    <a class="version" href="../../4.66/explanations/webhook-protection.html">4.66</a>
    <a class="version" href="../../4.65/explanations/webhook-protection.html">4.65</a>
    <a class="version" href="../../4.64/explanations/webhook-protection.html">4.64</a>
    <a class="version is-missing" href="../../4.63/index.html">4.63</a>
    <a class="version is-missing" href="../../4.62/index.html">4.62</a>
    <a class="version is-missing" href="../../4.61/index.html">4.61</a>
    <a class="version is-missing" href="../../4.60/index.html">4.60</a>
    <a class="version is-missing" href="../../4.59/index.html">4.59</a>
    <a class="version is-missing" href="../../4.58/index.html">4.58</a>
    <a class="version is-missing" href="../../4.57/index.html">4.57</a>
    <a class="version is-missing" href="../../4.56/index.html">4.56</a>
    <a class="version is-missing" href="../../4.55/index.html">4.55</a>
    <a class="version is-missing" href="../../4.54/index.html">4.54</a>
    <a class="version is-missing" href="../../4.53/index.html">4.53</a>
    <a class="version is-missing" href="../../4.52/index.html">4.52</a>
    <a class="version is-missing" href="../../4.51/index.html">4.51</a>
    <a class="version is-missing" href="../../4.50/index.html">4.50</a>
    <a class="version is-missing" href="../../4.49/index.html">4.49</a>
    <a class="version is-missing" href="../../4.48/index.html">4.48</a>
    <a class="version is-missing" href="../../4.47/index.html">4.47</a>
    <a class="version is-missing" href="../../4.46/index.html">4.46</a>
    <a class="version is-missing" href="../../4.45/index.html">4.45</a>
    <a class="version is-missing" href="../../4.44/index.html">4.44</a>
    <a class="version is-missing" href="../../4.43/index.html">4.43</a>
    <a class="version is-missing" href="../../4.42/index.html">4.42</a>
    <a class="version is-missing" href="../../4.41/index.html">4.41</a>
    <a class="version is-missing" href="../../4.40/index.html">4.40</a>
    <a class="version is-missing" href="../../4.39/index.html">4.39</a>
    <a class="version is-missing" href="../../4.38/index.html">4.38</a>
    <a class="version is-missing" href="../../4.37/index.html">4.37</a>
    <a class="version is-missing" href="../../4.36/index.html">4.36</a>
    <a class="version is-missing" href="../../4.35/index.html">4.35</a>
    <a class="version is-missing" href="../../4.34/index.html">4.34</a>
    <a class="version is-missing" href="../../4.33/index.html">4.33</a>
    <a class="version is-missing" href="../../4.32/index.html">4.32</a>
    <a class="version is-missing" href="../../4.31/index.html">4.31</a>
    <a class="version is-missing" href="../../4.30/index.html">4.30</a>
    <a class="version is-missing" href="../../4.29/index.html">4.29</a>
    <a class="version is-missing" href="../../4.28/index.html">4.28</a>
    <a class="version is-missing" href="../../4.27/index.html">4.27</a>
    <a class="version is-missing" href="../../4.26/index.html">4.26</a>
    <a class="version is-missing" href="../../4.25/index.html">4.25</a>
    <a class="version is-missing" href="../../4.24/index.html">4.24</a>
    <a class="version is-missing" href="../../4.23/index.html">4.23</a>
    <a class="version is-missing" href="../../4.22/index.html">4.22</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/vshn/appcat/edit/docs/v4.95/docs/modules/ROOT/pages/explanations/webhook-protection.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Webhook based deletion protection</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In order to protect some objects from accidental deletion, we added a webhook based deletion protection.
This deletion protection currently protects "backend" objects from being deleted while the composite still exists.
This does not (yet) protect the claims from accidental deletion.</p>
</div>
<div class="paragraph">
<p>It currently protects these objects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Instance namespaces</p>
</li>
<li>
<p>PVCs within those namespaces</p>
</li>
<li>
<p>XObjectBuckets belonging to an instance</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The protection can be toggled by using <code>.spec.parameters.backup.deletionProtection</code> in the top parent composite.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/protection.drawio.svg" alt="protection.drawio">
</div>
</div>
<div class="paragraph">
<p>By binding the protection to the topmost composite in any given nested service, we ensure that the protection cannot be circumvented by composition-functions.
The topmost composite is always the one that belongs to a claim.
Within composition functions it&#8217;s only possible to manipulate the <code>.status</code> field of that composite.
It cannot be deleted from within the composition functions, so it&#8217;s the ideal anchor to fixate the protection.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation"><a class="anchor" href="#_implementation"></a>Implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The implementation can protect objects in two cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It&#8217;s directly managed by Crossplane, either by being a managed resource, or by being deployed via provider-kubernetes</p>
</li>
<li>
<p>An object that&#8217;s not managed, but resides in a protected namespace</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the first case, Composition functions ensures that all objects deployed by Crossplane or provider-kubernetes contain labels about the composite it belongs to.
That information is then used during the Webhook to figure out if the composite is in a deleted state or not.
If it&#8217;s not in a deleted state, and the protection toggle is true, then it will block the deletion.
To avoid any deadlocks, as soon as the composite is either not found, or has <code>.metadata.deletionTimestamp</code> not nil, it will disengage the protection.</p>
</div>
<div class="paragraph">
<p>The second case is very similar.
The webhook reads the namespace the object belongs to and then uses the namespace with the logic for managed objects to determine the state of the protection.</p>
</div>
<div class="paragraph">
<p>If deletion protection needs to be added to a PnT managed objects, please ensure that the labels are set.</p>
</div>
<div class="sect2">
<h3 id="_why_are_we_not_using_ownerreferences_to_determine_the_parent_composite"><a class="anchor" href="#_why_are_we_not_using_ownerreferences_to_determine_the_parent_composite"></a>Why are we not using ownerReferences to determine the parent composite?</h3>
<div class="paragraph">
<p>The answer has multiple aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provider-kubernetes doesn&#8217;t set ownerRefs on its managed objects. This is due to the fact that ownerRefs have some limitations.The owners need to be either namespace scoped, or reside in the same namespace. As provider-kubernetes can manage remote clusters, the composite might not even be on the same cluster. Same applies to provider-helm.</p>
</li>
<li>
<p>Only Managed resources have ownerRefs to their composite.</p>
</li>
<li>
<p>For nested services, like Keycloak, the ownerReferences only point to the next composite in the chain. If for any reason one of the parent composites is missing, we can&#8217;t get to the parent anymore.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_override_deletion_protection"><a class="anchor" href="#_override_deletion_protection"></a>Override deletion protection</h3>
<div class="paragraph">
<p>Sometimes it&#8217;s necessary to delete some PVC even if the instance still exists.
For example if one node of a Galera cluster gets corrupted and needs to be re-initialized.</p>
</div>
<div class="paragraph">
<p>To achieve this, following label has to be set on that object.
That label will override the protection for exactly that object.</p>
</div>
<div class="paragraph">
<p><code>appcat.vshn.io/webhook-allowdeletion: "true"</code></p>
</div>
<div class="paragraph">
<p>The value has to be <code>"true"</code> or else it will not trigger the override.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>Copyright Â© VSHN 2021 â€“ All Rights Reserved. <a href="https://vshn.ch/en/privacy-policy/">Privacy Policy</a>, <a href="https://vshn.ch/en/imprint/">Imprint</a>, and <a href="https://vshn.ch/en/contact/">Contact</a>.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
  </body>
</html>
